<html lang="en"><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="Webpixels">
    <title></title>
    
    <!-- this is google map API style-->
        <style>
            /* Always set the map height explicitly to define the size of the div
             * element that contains the map. */
            #map {
              height: 100%;
              width: 100%;
            }
            /* Optional: Makes the sample page fill the window. */
            html, body {
              height: 100%;
              margin: 0;
              padding: 0;
            }
        </style>
    <!-- Preloader -->
    <style>
        @keyframes hidePreloader {
            0% {
                width: 100%;
                height: 100%;
            }

            100% {
                width: 0;
                height: 0;
            }
        }

        body>div.preloader {
            position: fixed;
            background: white;
            width: 100%;
            height: 100%;
            z-index: 1071;
            opacity: 0;
            transition: opacity .5s ease;
            overflow: hidden;
            pointer-events: none;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        body:not(.loaded)>div.preloader {
            opacity: 1;
        }

        body:not(.loaded) {
            overflow: hidden;
        }

        body.loaded>div.preloader {
            animation: hidePreloader .5s linear .5s forwards;
        }
    </style>
    <script>
        window.addEventListener("load", function() {
            setTimeout(function() {
                document.querySelector('body').classList.add('loaded');
            }, 300);
        });
    </script>
    <!-- Favicon -->
    <link rel="icon" href="assets/img/brand/favicon.png" type="image/png"><!-- Font Awesome -->
    <link rel="stylesheet" href="assets/libs/@fortawesome/fontawesome-free/css/all.min.css">
    <!-- Quick CSS -->
    <link rel="stylesheet" href="assets/css/quick-website.css" id="stylesheet">
    <link rel="stylesheet" href="assets/css/main.css" id="stylesheet">
    <link rel="stylesheet" href="assets/js/layui/css/layui.css" id="stylesheet">
    
    <script src="assets/js/Main.js"></script>
    <link id="layuicss-laydate" rel="stylesheet" href="http://localhost/assign2/assets/js/layui/css/modules/laydate/default/laydate.css?v=5.0.9" media="all"><link id="layuicss-layer" rel="stylesheet" href="http://localhost/assign2/assets/js/layui/css/modules/layer/default/layer.css?v=3.1.1" media="all"><link id="layuicss-skincodecss" rel="stylesheet" href="http://localhost/assign2/assets/js/layui/css/modules/code.css" media="all"></head>

<body data-gr-c-s-loaded="true" class="loaded">
    <!-- Preloader -->
    <div class="preloader">
        <div class="spinner-border text-primary" role="status">
            <span class="sr-only">Loading...</span>
        </div>
    </div>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-light bg-white">
        <div class="container">
            <!-- Brand -->
            <a class="navbar-brand" href="booking.html">
                <img alt="Image placeholder" src="assets/img/brand/taxi.svg" style="height: 100px;" id="navbar-logo">
            </a>
            <!-- Toggler -->
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <!-- Collapse -->
            <div class="collapse navbar-collapse" id="navbarCollapse">
                <ul class="navbar-nav mt-4 mt-lg-0 ml-auto">
                    <li class="nav-item ">
                        <a class="nav-link" href="booking.html" style="font-size: 1.2rem;">Homepage</a>
                    </li>
                    <li class="nav-item ">
                        <a class="nav-link" href="admin.html" style="font-size: 1.2rem;">Admin</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <!-- Main content -->
    <section class="slice py-7">
        <div class="container">
            <div class="row row-grid align-items-center">
                <div class="col-12 col-md-5 col-lg-6 order-md-2 text-center">
                    <!-- Image -->
                    <figure class="w-100">
                        <img alt="Image placeholder" src="assets/img/svg/illustrations/illustration-12.svg" class="img-fluid mw-md-120">
                    </figure>
                </div>
                <div class="col-12 col-md-7 col-lg-6 order-md-1 pr-md-5">
                    <!-- Heading -->
                    <h1 class="display-4 text-center text-md-left mb-3">
                        It's time to travel by <strong class="text-primary">Booking a car at CabsOnline</strong>
                    </h1>
                    <!-- Text -->
                    <p class="lead text-center text-md-left text-muted">
                        This assignment is aims to bulid a website for customer booking a car online.
                    </p>
                    <!-- Buttons -->
                    <div class="text-center text-md-left mt-5">
                        <a href="#getstart" class="btn btn-primary btn-icon">
                            <span class="btn-inner--text">Find Your Order Here</span>
                            <span class="btn-inner--icon"><i data-feather="chevron-right"></i></span>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </section>
        <div class="container">
            <!-- Title -->
            <!-- Section title -->
            <div class="row mb-5 justify-content-center text-center">
                <div class="col-lg-6">
                    <div id="getstart">
                    <span class="badge badge-soft-success badge-pill badge-lg">
                        Get started
                    </span>
                    </div>
                     <h2 class=" mt-4">Search Taxi Order</h2>
        </div>
    </div>
    <!-- Card -->
    <div class="row mt-5">
        <div class="col-md-12">
            <div class="card">
                <div class="card-body pb-5">
                    <div class="wrap-contact100 search-order">
                        <!--<form class="form-inline">-->
                            <div class="search-input">
                                <label class="sr-only" for="exampleInputAmount">Amount (in dollars)</label>
                                <div class="input-group">
                                    <input type="text" class="form-control keyword " id="exampleInputAmount" placeholder="Enter Your Booking Number">
                                </div>
                            </div>
                            <button type="submit" class="btn btn-primary btn-icon" onclick="search(1)">Search</button>
                            <button type="submit" class="btn btn-primary btn-icon" onclick="search(2)">Search All</button>
                        <!--</form>-->
                    </div>
                    <div class="numbers table-responsive">
                        <table class="table table-hover table-striped" style="font-size:21px;">
                            <thead>
                                <tr style="color: #008aff;">
                                    <th>Booking Number</th>
                                    <th>User Name</th>
                                    <th>Pick-up Time</th>
                                    <th>Pick-up Address</th>
                                    <th>Destination</th>
                                    <th style="width:20%">Status</th>
                                    <th>Operating</th>
                                </tr>
                            </thead>
                            <tbody class="tbody">

                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
        </div>
    
    <section class="slice slice-lg">
        <div class="container">
            <div class="py-6">
                <div class="row row-grid justify-content-between align-items-center">
                    <div class="col-lg-5">
                        <h5 class="h3">Click the Picture on thr Right for </h5><h2 style="color: #008aff;">Visiting Booking Page to Get Your Taxi now</h2>
                        <p class="lead my-4">
                            What you can do in Booking Page:
                        </p>
                        <ul class="list-unstyled mb-0">
                            <li class="py-2">
                                <div class="d-flex align-items-center">
                                    <div>
                                        <div class="icon icon-shape bg-primary text-white icon-sm rounded-circle mr-3">
                                            <i class="fas fa-file-invoice"></i>
                                        </div>
                                    </div>
                                    <div>
                                        <span class="h6 mb-0">Fill up the form and Get your Taxi ASAP</span>
                                    </div>
                                </div>
                            </li>
                            <li class="py-2">
                                <div class="d-flex align-items-center">
                                    <div>
                                        <div class="icon icon-shape bg-primary text-white icon-sm rounded-circle mr-3">
                                            <i class="fas fa-store-alt"></i>
                                        </div>
                                    </div>
                                    <div>
                                        <span class="h6 mb-0">Booking Taxi Online</span>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                    <div class="col-lg-6">
                        <div class="card mb-0 ml-lg-5">
                            <div class="card-body p-2">
                                <a href="booking.html">
                                <img alt="Image placeholder" src="assets/img/theme/light/booking.jpg" class="img-fluid shadow rounded">
                            </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <footer class="position-relative" id="footer-main">
        <div class="footer pt-lg-7 footer-dark bg-dark">
            <!-- SVG shape -->
            <div class="shape-container shape-line shape-position-top shape-orientation-inverse">
                <svg width="2560px" height="100px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" preserveAspectRatio="none" x="0px" y="0px" viewBox="0 0 2560 100" style="enable-background:new 0 0 2560 100;" xml:space="preserve" class=" fill-section-secondary">
                    <polygon points="2560 0 2560 100 0 100"></polygon>
                </svg>
            </div>
            <!-- Footer -->
            <div class="container pt-4">
                <div class="row">
                    <div class="col-lg-4 mb-5 mb-lg-0">
                        <!-- Theme's logo -->
                        <a href="booking.html">
                            <img alt="Image placeholder" src="assets/img/brand/taxi2.png" id="footer-logo">
                        </a>
                        <!-- Webpixels' mission -->
                        <p class="mt-4 text-sm opacity-8 pr-lg-4">The CabsOnline is builded for users to call taxi online. It's designed and implemented by company call "Quick" and it's modified by MengLong Yao to his own specific function</p>
                        <!-- Social -->
                        <ul class="nav mt-4">
                            <li class="nav-item">
                                <a class="nav-link pl-0" href="#" target="_blank">
                                    <i class="fab fa-dribbble"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#" target="_blank">
                                    <i class="fab fa-github"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#" target="_blank">
                                    <i class="fab fa-instagram"></i>
                                </a>
                            </li>

                    </div>
                    <div class=" col-sm-4 ml-lg-auto">
                        <div id="map"></div>
                    </div>
                </div>
                <hr class="divider divider-fade divider-dark my-4">
                <div class="row align-items-center justify-content-md-between pb-4">
                    <div class="col-md-6">
                        <div class="copyright text-sm font-weight-bold text-center text-md-left">
                            Copyright © 2020. All rights reserved Menglong Yao.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!-- Quick JS -->
    <script src="assets/js/jquery-1.12.1.min.js"></script>
    <script src="assets/js/layui/layui.all.js"></script>
    <!-- Feather Icons -->
    <script>
        feather.replace({
            'width': '1em',
            'height': '1em'
        });
        //Search Taxi orders
        function search(type){
            let number = $(".keyword").val();
            //If it is specified to check an order, it cannot be empty
            if(type == 1 && number == ''){
                layer.msg('Please enter your booking reference number !');
                $(".keyword").focus();
                return false;
            }
            //ajax search Taxi orders
            $.ajax({
                type:'post',
                data:{op:'search',type:type,number:number},
                url:'server.php',
                dataType:'json',
                success:function(res){
                    if(res.errcode == 0){
                        if(res.data.length > 0){
                            //Splicing order html
                            let html = '';
                            $.each(res.data,function(i,e){
                                html += '<tr>' +
                                    '<td>'+e.number+'</td>' +
                                    '<td>'+e.customer_name+'</td>' +
                                    '<td>'+e.pickuptime+'</td>' +
                                    '<td>'+e.pickupaddress+'</td>' +
                                    '<td>'+e.destination+'</td>' +
                                    '<td class="status">'+e.status+'</td>' +
                                    '<td><a href="javascript:void(0)" onclick="distribution(this,'+e.number+')" class="btn btn-primary btn-icon">Assigning Now</a></td>' +
                                    '</tr>'
                            });
                            $(".tbody").html(html);
                            $(".numbers").show();
                        }else{
                            //Not found booking number, give a hint
                            layer.msg('The Booking number was not found!');
                        }
                    }else{
                        layer.msg(res.msg);
                    }
                },
                error:function(){
                    layer.msg('The system is broken, please try again !')
                }
            });
        }
        //Assign taxi for user
        function distribution(_this,number){
            if(number == ''){
                layer.msg('failed to assign, please check the order status!');
                return false;
            }
            //assigning
            $.ajax({
                type:'post',
                data:{op:'distribution',number:number},
                url:'server.php',
                dataType:'json',
                success:function(res){
                    if(res.errcode == 0){
                        //assign result
                       let html = 'The booking request <b><'+number+'></b> has been properly assigned';
                        // let html = 'assigned';
                        $(_this).parents("tr").find(".status").html(html);
                        //remove the assign button when assigned
                        $(_this).remove();
                    }else{
                        //hint if any errors
                        layer.msg(res.msg);
                    }
                },
                error:function(){
                    layer.msg('The system is broken, please try again !')
                }
            });
    
        }
    </script>
        <script>
            // Note: This example requires that you consent to location sharing when
            // prompted by your browser. If you see the error "The Geolocation service
            // failed.", it means you probably did not give permission for the browser to
            // locate you.
            var map, infoWindow;
            function initMap() {
              map = new google.maps.Map(document.getElementById('map'), {
                center: {lat: -34.397, lng: 150.644},
                zoom: 6
              });
              infoWindow = new google.maps.InfoWindow;
      
              // Try HTML5 geolocation.
              if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function(position) {
                  var pos = {
                    lat: position.coords.latitude,
                    lng: position.coords.longitude
                  };
      
                  infoWindow.setPosition(pos);
                  infoWindow.setContent('Location found.');
                  infoWindow.open(map);
                  map.setCenter(pos);
                }, function() {
                  handleLocationError(true, infoWindow, map.getCenter());
                });
              } else {
                // Browser doesn't support Geolocation
                handleLocationError(false, infoWindow, map.getCenter());
              }
            }
      
            function handleLocationError(browserHasGeolocation, infoWindow, pos) {
              infoWindow.setPosition(pos);
              infoWindow.setContent(browserHasGeolocation ?
                                    'Error: The Geolocation service failed.' :
                                    'Error: Your browser doesn\'t support geolocation.');
              infoWindow.open(map);
            }
          </script>
          <script async defer
          src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAeJRYFIun1e2pOOyW9SI7rjHTiSAJgejc&callback=initMap">
          </script>


<div class="layui-layer-move">

</div>
</body>
</html>